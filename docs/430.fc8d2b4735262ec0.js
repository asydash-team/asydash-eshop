"use strict";(self.webpackChunkeshop=self.webpackChunkeshop||[]).push([[430],{9430:(te,C,u)=>{u.r(C),u.d(C,{SettingModule:()=>_});var h=u(6895),p=u(5197),e=u(1571),y=u(2453);class f{static#e=this.\u0275fac=function(t){return new(t||f)};static#t=this.\u0275cmp=e.Xpm({type:f,selectors:[["eshop-layout"]],decls:15,vars:0,consts:[["position","bottom-center","key","bc"],[1,"grid"],[1,"col-12"],[1,"menubar"],[1,"menu__button"],["type","button","routerLink","account-info","routerLinkActive","active",1,"py-2"],[1,"pi","pi-user","mr-2"],["type","button","routerLink","account-security","routerLinkActive","active",1,"py-2"],[1,"pi","pi-lock","mr-2"]],template:function(t,i){1&t&&(e._UZ(0,"p-toast",0),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",1)(5,"div",2)(6,"div",4)(7,"button",5),e._UZ(8,"i",6),e._uU(9,"Information "),e.qZA(),e.TgZ(10,"button",7),e._UZ(11,"i",8),e._uU(12,"Security "),e.qZA()()()()()(),e.TgZ(13,"div",2),e._UZ(14,"router-outlet"),e.qZA()())},dependencies:[p.lC,p.rH,p.Od,y.FN],encapsulation:2})}var l=u(433),v=u(9034),T=u(3040),w=u(805),I=u(5832),m=u(1740),b=u(9592),k=u(4418);const q=["input"];function x(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"i",3),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.clear())}),e.qZA()}}const M={provide:l.JU,useExisting:(0,e.Gpc)(()=>Z),multi:!0};let Z=(()=>{class n{constructor(t,i){this.el=t,this.cd=i,this.type="text",this.slotChar="_",this.autoClear=!0,this.showClear=!1,this.characterPattern="[A-Za-z]",this.onComplete=new e.vpe,this.onFocus=new e.vpe,this.onBlur=new e.vpe,this.onInput=new e.vpe,this.onKeydown=new e.vpe,this.onClear=new e.vpe,this.onModelChange=()=>{},this.onModelTouched=()=>{}}ngOnInit(){let t=b.p.getUserAgent();this.androidChrome=/chrome/i.test(t)&&/android/i.test(t),this.initMask()}get mask(){return this._mask}set mask(t){this._mask=t,this.initMask(),this.writeValue(""),this.onModelChange(this.value)}initMask(){this.tests=[],this.partialPosition=this.mask.length,this.len=this.mask.length,this.firstNonMaskPos=null,this.defs={9:"[0-9]",a:this.characterPattern,"*":`${this.characterPattern}|[0-9]`};let t=this.mask.split("");for(let i=0;i<t.length;i++){let s=t[i];"?"==s?(this.len--,this.partialPosition=i):this.defs[s]?(this.tests.push(new RegExp(this.defs[s])),null===this.firstNonMaskPos&&(this.firstNonMaskPos=this.tests.length-1),i<this.partialPosition&&(this.lastRequiredNonMaskPos=this.tests.length-1)):this.tests.push(null)}this.buffer=[];for(let i=0;i<t.length;i++){let s=t[i];"?"!=s&&this.buffer.push(this.defs[s]?this.getPlaceholder(i):s)}this.defaultBuffer=this.buffer.join("")}writeValue(t){this.value=t,this.inputViewChild&&this.inputViewChild.nativeElement&&(this.inputViewChild.nativeElement.value=null==this.value||null==this.value?"":this.value,this.checkVal(),this.focusText=this.inputViewChild.nativeElement.value,this.updateFilledState())}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}setDisabledState(t){this.disabled=t,this.cd.markForCheck()}caret(t,i){let s,r,a;if(this.inputViewChild.nativeElement.offsetParent&&this.inputViewChild.nativeElement===this.inputViewChild.nativeElement.ownerDocument.activeElement){if("number"!=typeof t)return this.inputViewChild.nativeElement.setSelectionRange?(r=this.inputViewChild.nativeElement.selectionStart,a=this.inputViewChild.nativeElement.selectionEnd):document.selection&&document.selection.createRange&&(s=document.selection.createRange(),r=0-s.duplicate().moveStart("character",-1e5),a=r+s.text.length),{begin:r,end:a};r=t,a="number"==typeof i?i:r,this.inputViewChild.nativeElement.setSelectionRange?this.inputViewChild.nativeElement.setSelectionRange(r,a):this.inputViewChild.nativeElement.createTextRange&&(s=this.inputViewChild.nativeElement.createTextRange(),s.collapse(!0),s.moveEnd("character",a),s.moveStart("character",r),s.select())}}isCompleted(){for(let i=this.firstNonMaskPos;i<=this.lastRequiredNonMaskPos;i++)if(this.tests[i]&&this.buffer[i]===this.getPlaceholder(i))return!1;return!0}getPlaceholder(t){return this.slotChar.charAt(t<this.slotChar.length?t:0)}seekNext(t){for(;++t<this.len&&!this.tests[t];);return t}seekPrev(t){for(;--t>=0&&!this.tests[t];);return t}shiftL(t,i){let s,r;if(!(t<0)){for(s=t,r=this.seekNext(i);s<this.len;s++)if(this.tests[s]){if(!(r<this.len&&this.tests[s].test(this.buffer[r])))break;this.buffer[s]=this.buffer[r],this.buffer[r]=this.getPlaceholder(r),r=this.seekNext(r)}this.writeBuffer(),this.caret(Math.max(this.firstNonMaskPos,t))}}shiftR(t){let i,s,r,a;for(i=t,s=this.getPlaceholder(t);i<this.len;i++)if(this.tests[i]){if(r=this.seekNext(i),a=this.buffer[i],this.buffer[i]=s,!(r<this.len&&this.tests[r].test(a)))break;s=a}}handleAndroidInput(t){var i=this.inputViewChild.nativeElement.value,s=this.caret();if(this.oldVal&&this.oldVal.length&&this.oldVal.length>i.length){for(this.checkVal(!0);s.begin>0&&!this.tests[s.begin-1];)s.begin--;if(0===s.begin)for(;s.begin<this.firstNonMaskPos&&!this.tests[s.begin];)s.begin++;setTimeout(()=>{this.caret(s.begin,s.begin),this.updateModel(t),this.isCompleted()&&this.onComplete.emit()},0)}else{for(this.checkVal(!0);s.begin<this.len&&!this.tests[s.begin];)s.begin++;setTimeout(()=>{this.caret(s.begin,s.begin),this.updateModel(t),this.isCompleted()&&this.onComplete.emit()},0)}}onInputBlur(t){if(this.focused=!1,this.onModelTouched(),this.checkVal(),this.updateFilledState(),this.onBlur.emit(t),this.inputViewChild.nativeElement.value!=this.focusText||this.inputViewChild.nativeElement.value!=this.value){this.updateModel(t);let i=document.createEvent("HTMLEvents");i.initEvent("change",!0,!1),this.inputViewChild.nativeElement.dispatchEvent(i)}}onInputKeydown(t){if(this.readonly)return;let s,r,a,i=t.which||t.keyCode,c=/iphone/i.test(b.p.getUserAgent());this.oldVal=this.inputViewChild.nativeElement.value,this.onKeydown.emit(t),8===i||46===i||c&&127===i?(s=this.caret(),r=s.begin,a=s.end,a-r==0&&(r=46!==i?this.seekPrev(r):a=this.seekNext(r-1),a=46===i?this.seekNext(a):a),this.clearBuffer(r,a),this.shiftL(r,a-1),this.updateModel(t),this.onInput.emit(t),t.preventDefault()):13===i?(this.onInputBlur(t),this.updateModel(t)):27===i&&(this.inputViewChild.nativeElement.value=this.focusText,this.caret(0,this.checkVal()),this.updateModel(t),t.preventDefault())}onKeyPress(t){if(!this.readonly){var r,a,c,A,i=t.which||t.keyCode,s=this.caret();t.ctrlKey||t.altKey||t.metaKey||i<32||i>34&&i<41||(i&&13!==i&&(s.end-s.begin!=0&&(this.clearBuffer(s.begin,s.end),this.shiftL(s.begin,s.end-1)),(r=this.seekNext(s.begin-1))<this.len&&(a=String.fromCharCode(i),this.tests[r].test(a)&&(this.shiftR(r),this.buffer[r]=a,this.writeBuffer(),c=this.seekNext(r),/android/i.test(b.p.getUserAgent())?setTimeout(()=>{this.caret(c)},0):this.caret(c),s.begin<=this.lastRequiredNonMaskPos&&(A=this.isCompleted()),this.onInput.emit(t))),t.preventDefault()),this.updateModel(t),this.updateFilledState(),A&&this.onComplete.emit())}}clearBuffer(t,i){let s;for(s=t;s<i&&s<this.len;s++)this.tests[s]&&(this.buffer[s]=this.getPlaceholder(s))}writeBuffer(){this.inputViewChild.nativeElement.value=this.buffer.join("")}checkVal(t){let r,a,c,i=this.inputViewChild.nativeElement.value,s=-1;for(r=0,c=0;r<this.len;r++)if(this.tests[r]){for(this.buffer[r]=this.getPlaceholder(r);c++<i.length;)if(a=i.charAt(c-1),this.tests[r].test(a)){this.buffer[r]=a,s=r;break}if(c>i.length){this.clearBuffer(r+1,this.len);break}}else this.buffer[r]===i.charAt(c)&&c++,r<this.partialPosition&&(s=r);return t?this.writeBuffer():s+1<this.partialPosition?this.autoClear||this.buffer.join("")===this.defaultBuffer?(this.inputViewChild.nativeElement.value&&(this.inputViewChild.nativeElement.value=""),this.clearBuffer(0,this.len)):this.writeBuffer():(this.writeBuffer(),this.inputViewChild.nativeElement.value=this.inputViewChild.nativeElement.value.substring(0,s+1)),this.partialPosition?r:this.firstNonMaskPos}onInputFocus(t){if(this.readonly)return;let i;this.focused=!0,clearTimeout(this.caretTimeoutId),this.focusText=this.inputViewChild.nativeElement.value,i=this.checkVal(),this.caretTimeoutId=setTimeout(()=>{this.inputViewChild.nativeElement===this.inputViewChild.nativeElement.ownerDocument.activeElement&&(this.writeBuffer(),i==this.mask.replace("?","").length?this.caret(0,i):this.caret(i))},10),this.onFocus.emit(t)}onInputChange(t){this.androidChrome?this.handleAndroidInput(t):this.handleInputChange(t),this.onInput.emit(t)}handleInputChange(t){this.readonly||setTimeout(()=>{var i=this.checkVal(!0);this.caret(i),this.updateModel(t),this.isCompleted()&&this.onComplete.emit()},0)}getUnmaskedValue(){let t=[];for(let i=0;i<this.buffer.length;i++){let s=this.buffer[i];this.tests[i]&&s!=this.getPlaceholder(i)&&t.push(s)}return t.join("")}updateModel(t){const i=this.unmask?this.getUnmaskedValue():t.target.value;(null!==i||void 0!==i)&&(this.value=i,this.onModelChange(this.value))}updateFilledState(){this.filled=this.inputViewChild.nativeElement&&""!=this.inputViewChild.nativeElement.value}focus(){this.inputViewChild.nativeElement.focus()}clear(){this.inputViewChild.nativeElement.value="",this.value=null,this.onModelChange(this.value),this.onClear.emit()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.SBq),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["p-inputMask"]],viewQuery:function(t,i){if(1&t&&e.Gf(q,7),2&t){let s;e.iGM(s=e.CRH())&&(i.inputViewChild=s.first)}},hostAttrs:[1,"p-element"],hostVars:6,hostBindings:function(t,i){2&t&&e.ekj("p-inputwrapper-filled",i.filled)("p-inputwrapper-focus",i.focused)("p-inputmask-clearable",i.showClear&&!i.disabled)},inputs:{type:"type",slotChar:"slotChar",autoClear:"autoClear",showClear:"showClear",style:"style",inputId:"inputId",styleClass:"styleClass",placeholder:"placeholder",size:"size",maxlength:"maxlength",tabindex:"tabindex",title:"title",ariaLabel:"ariaLabel",ariaRequired:"ariaRequired",disabled:"disabled",readonly:"readonly",unmask:"unmask",name:"name",required:"required",characterPattern:"characterPattern",autoFocus:"autoFocus",autocomplete:"autocomplete",mask:"mask"},outputs:{onComplete:"onComplete",onFocus:"onFocus",onBlur:"onBlur",onInput:"onInput",onKeydown:"onKeydown",onClear:"onClear"},features:[e._Bn([M])],decls:3,vars:18,consts:[["pInputText","","pAutoFocus","",1,"p-inputmask",3,"ngStyle","ngClass","disabled","readonly","autofocus","focus","blur","keydown","keypress","input","paste"],["input",""],["class","p-inputmask-clear-icon pi pi-times",3,"click",4,"ngIf"],[1,"p-inputmask-clear-icon","pi","pi-times",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"input",0,1),e.NdJ("focus",function(r){return i.onInputFocus(r)})("blur",function(r){return i.onInputBlur(r)})("keydown",function(r){return i.onInputKeydown(r)})("keypress",function(r){return i.onKeyPress(r)})("input",function(r){return i.onInputChange(r)})("paste",function(r){return i.handleInputChange(r)}),e.qZA(),e.YNc(2,x,1,0,"i",2)),2&t&&(e.Q6J("ngStyle",i.style)("ngClass",i.styleClass)("disabled",i.disabled)("readonly",i.readonly)("autofocus",i.autoFocus),e.uIk("id",i.inputId)("type",i.type)("name",i.name)("placeholder",i.placeholder)("title",i.title)("size",i.size)("autocomplete",i.autocomplete)("maxlength",i.maxlength)("tabindex",i.tabindex)("aria-label",i.ariaLabel)("aria-required",i.ariaRequired)("required",i.required),e.xp6(2),e.Q6J("ngIf",null!=i.value&&i.filled&&i.showClear&&!i.disabled))},dependencies:[h.mk,h.O5,h.PC,m.o,k.P],styles:[".p-inputmask-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-inputmask-clearable{position:relative}\n"],encapsulation:2,changeDetection:0}),n})(),E=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[h.ez,m.j,k.E]}),n})();function P(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1," required "),e.qZA())}function V(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1,"invalid"),e.qZA())}function N(n,o){if(1&n&&(e.TgZ(0,"small",21),e._uU(1," Name is "),e.YNc(2,P,2,0,"span",22),e.YNc(3,V,2,0,"span",22),e.qZA()),2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",t.form.controls.email.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.form.controls.email.hasError("email"))}}function U(n,o){1&n&&(e.TgZ(0,"small",21),e._uU(1," Name is required "),e.qZA())}function S(n,o){1&n&&(e.TgZ(0,"small",21),e._uU(1," Phone number is required "),e.qZA())}function F(n,o){1&n&&(e.TgZ(0,"small",21),e._uU(1," Street is required "),e.qZA())}function J(n,o){1&n&&(e.TgZ(0,"small",21),e._uU(1," Country is required "),e.qZA())}function B(n,o){1&n&&(e.TgZ(0,"small",21),e._uU(1," Apartment is required "),e.qZA())}function Y(n,o){1&n&&(e.TgZ(0,"small",21),e._uU(1," City is required "),e.qZA())}function Q(n,o){1&n&&(e.TgZ(0,"small",21),e._uU(1," Zip is required "),e.qZA())}function D(n,o){if(1&n&&(e.TgZ(0,"div",23)(1,"small",24),e._uU(2),e.qZA()()),2&n){const t=e.oxw(2);e.xp6(2),e.hij(" ",t.errorMessage," ")}}function L(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"form",2),e.NdJ("ngSubmit",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.onSubmit())}),e.TgZ(1,"div",3)(2,"label",4),e._uU(3,"Email"),e.qZA(),e._UZ(4,"input",5),e.YNc(5,N,4,2,"small",6),e.qZA(),e.TgZ(6,"div",3)(7,"label",4),e._uU(8,"Name"),e.qZA(),e._UZ(9,"input",7),e.YNc(10,U,2,0,"small",6),e.qZA(),e.TgZ(11,"div",3)(12,"label",4),e._uU(13,"Phone Number"),e.qZA(),e._UZ(14,"p-inputMask",8),e.YNc(15,S,2,0,"small",6),e.qZA(),e.TgZ(16,"div",3)(17,"label",4),e._uU(18,"Street"),e.qZA(),e._UZ(19,"input",9),e.YNc(20,F,2,0,"small",6),e.qZA(),e.TgZ(21,"div",10)(22,"label",4),e._uU(23,"Country"),e.qZA(),e._UZ(24,"p-dropdown",11),e.YNc(25,J,2,0,"small",6),e.qZA(),e.TgZ(26,"div",10)(27,"label",4),e._uU(28,"Apartment"),e.qZA(),e._UZ(29,"input",12),e.YNc(30,B,2,0,"small",6),e.qZA(),e.TgZ(31,"div",10)(32,"label",4),e._uU(33,"City"),e.qZA(),e._UZ(34,"input",13),e.YNc(35,Y,2,0,"small",6),e.qZA(),e.TgZ(36,"div",10)(37,"label",4),e._uU(38,"Zip"),e.qZA(),e._UZ(39,"input",14),e.YNc(40,Q,2,0,"small",6),e.qZA(),e.YNc(41,D,3,1,"div",15),e.TgZ(42,"div",16)(43,"button",17),e._UZ(44,"i",18),e._uU(45,"Save "),e.qZA(),e.TgZ(46,"button",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.onRefresh())}),e._UZ(47,"i",20),e._uU(48,"Discuss "),e.qZA()()()}if(2&n){const t=e.oxw();e.Q6J("formGroup",t.form),e.xp6(5),e.Q6J("ngIf",t.form.controls.email.touched&&t.form.controls.email.invalid),e.xp6(5),e.Q6J("ngIf",t.form.controls.name.touched&&t.form.controls.name.hasError("required")),e.xp6(5),e.Q6J("ngIf",t.form.controls.phone.touched&&t.form.controls.phone.hasError("required")),e.xp6(5),e.Q6J("ngIf",t.form.controls.street.touched&&t.form.controls.street.hasError("required")),e.xp6(4),e.Q6J("options",t.objCountry)("filter",!0)("showClear",!0),e.xp6(1),e.Q6J("ngIf",t.form.controls.country.touched&&t.form.controls.country.hasError("required")),e.xp6(5),e.Q6J("ngIf",t.form.controls.apartment.touched&&t.form.controls.apartment.hasError("required")),e.xp6(5),e.Q6J("ngIf",t.form.controls.city.touched&&t.form.controls.city.hasError("required")),e.xp6(5),e.Q6J("ngIf",t.form.controls.zip.touched&&t.form.controls.zip.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.errorMessage)}}function j(n,o){1&n&&e._UZ(0,"div",25)}class d{constructor(o,t,i){this.fb=o,this.service=t,this.messageService=i,this.errorMessage="",this.currentId="",this.isLoading=!1,this.form=this.fb.group({name:["",l.kI.required],email:["",[l.kI.required,l.kI.email]],password:["",[l.kI.required]],confirmPassword:["",[l.kI.required]],street:["",[l.kI.required]],apartment:["",[l.kI.required]],city:["",[l.kI.required]],zip:["",[l.kI.required]],country:["",[l.kI.required]],phone:["",[l.kI.required]],isAdmin:[!1]})}ngOnInit(){this._fetchData(),this._getCountries()}onSubmit(){this._updateItem({id:this.currentId,email:this.userForm.email.value,password:this.userForm.password.value,name:this.userForm.name.value,phone:this.userForm.phone.value,street:this.userForm.street.value,apartment:this.userForm.apartment.value,city:this.userForm.city.value,zip:this.userForm.zip.value,country:this.userForm.country.value,isAdmin:this.userForm.isAdmin.value})}_updateItem(o){this.isLoading=!0,this.service.updateUser(o).subscribe(()=>{this.messageService.add({key:"bc",severity:"success",summary:"User Information",detail:"Update information successfully"}),this.isLoading=!1,this.service.initAppSession()},t=>{this.messageService.add({key:"bc",severity:"error",summary:`(${t.status}) ${t.statusText}`,detail:"Can't update information"})})}onRefresh(){this._fetchData()}_fetchData(){this.isLoading=!0,this.service._currentUser().subscribe(o=>{o&&(this.isLoading=!1,this.currentId=o._id,this.userForm.name.setValue(o.name),this.userForm.email.setValue(o.email),this.userForm.street.setValue(o.street),this.userForm.apartment.setValue(o.apartment),this.userForm.city.setValue(o.city),this.userForm.zip.setValue(o.zip),this.userForm.country.setValue(o.country),this.userForm.phone.setValue(o.phone),this.userForm.isAdmin.setValue(o.isAdmin),this.userForm.password.setValidators([]),this.userForm.password.updateValueAndValidity())})}_getCountries(){T.registerLocale(u(1086)),this.objCountry=Object.entries(T.getNames("en",{select:"official"})).map(o=>({_id:o[0],name:o[1]}))}get userForm(){return this.form.controls}static#e=this.\u0275fac=function(t){return new(t||d)(e.Y36(l.qu),e.Y36(v.KD),e.Y36(w.ez))};static#t=this.\u0275cmp=e.Xpm({type:d,selectors:[["eshop-account-info"]],decls:3,vars:2,consts:[["class","formgrid grid p-fluid","id","admin__form",3,"formGroup","ngSubmit",4,"ngIf","ngIfElse"],["loading",""],["id","admin__form",1,"formgrid","grid","p-fluid",3,"formGroup","ngSubmit"],[1,"field","col-6"],[1,"block"],["formControlName","email","type","text","pInputText","","required",""],["class","p-error block",4,"ngIf"],["formControlName","name","type","text","pInputText","","required",""],["mask","(999) 99-999-999","formControlName","phone","placeholder","(999) 99-999-999"],["formControlName","street","type","text","pInputText","","required",""],[1,"field","col-3"],["formControlName","country","optionLabel","name","optionValue","_id","filterBy","name","placeholder","Select a country",3,"options","filter","showClear"],["formControlName","apartment","type","text","pInputText","","required",""],["formControlName","city","type","text","pInputText","","required",""],["formControlName","zip","type","text","pInputText","","required",""],["class","field col-12",4,"ngIf"],[1,"col-12"],["type","submit",1,"btn","btn--primary"],[1,"pi","pi-save"],["type","button",1,"btn","btn--light",3,"click"],[1,"pi","pi-refresh"],[1,"p-error","block"],[4,"ngIf"],[1,"field","col-12"],[1,"p-error"],[1,"custom-loader"]],template:function(t,i){if(1&t&&(e.YNc(0,L,49,13,"form",0),e.YNc(1,j,1,0,"ng-template",null,1,e.W1O)),2&t){const s=e.MAs(2);e.Q6J("ngIf",!i.isLoading)("ngIfElse",s)}},dependencies:[h.O5,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.sg,l.u,I.Lt,m.o,Z],encapsulation:2})}function R(n,o){1&n&&(e.TgZ(0,"small",15),e._uU(1," Old password is required "),e.qZA())}function z(n,o){1&n&&(e.TgZ(0,"small",15),e._uU(1," New password is required "),e.qZA())}function O(n,o){1&n&&(e.TgZ(0,"small",15),e._uU(1," Confirm password is required "),e.qZA())}function K(n,o){1&n&&(e.TgZ(0,"small",15),e._uU(1," Password is not match "),e.qZA())}function G(n,o){if(1&n&&(e.TgZ(0,"div",16)(1,"small",15),e._uU(2),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.hij(" ",t.errorMessage," ")}}class g{constructor(o,t,i,s){this.fb=o,this.auth=t,this.service=i,this.router=s,this.currentId="",this.errorMessage="",this.form=this.fb.group({oldPassword:["",[l.kI.required]],newPassword:["",[l.kI.required]],confirmPassword:["",[l.kI.required]]})}ngOnInit(){this._fetchData()}onSubmit(){this.form.valid&&this.form.controls.newPassword.value==this.form.controls.confirmPassword.value?this.service.updatePassword(this.currentId,{oldPassword:this.formControl.oldPassword.value,newPassword:this.formControl.newPassword.value}).subscribe(()=>{this.auth.logout(),this.service.initAppSession(),this.router.navigate(["/login"])},o=>{this.errorMessage=o.error.message}):(this.form.controls.oldPassword.markAllAsTouched(),this.form.controls.newPassword.markAllAsTouched(),this.form.controls.confirmPassword.markAllAsTouched())}_fetchData(){this.service._currentUser().subscribe(o=>{o&&(this.currentId=o._id)})}get formControl(){return this.form.controls}static#e=this.\u0275fac=function(t){return new(t||g)(e.Y36(l.qu),e.Y36(v.e8),e.Y36(v.KD),e.Y36(p.F0))};static#t=this.\u0275cmp=e.Xpm({type:g,selectors:[["eshop-account-security"]],decls:31,vars:6,consts:[["id","admin__form",1,"formgrid","grid","p-fluid",3,"formGroup","ngSubmit"],[1,"field","col-7"],[1,"block"],[1,"p-input-icon-left"],[1,"pi","pi-key"],["formControlName","oldPassword","type","password","pInputText",""],["class","p-error",4,"ngIf"],["formControlName","newPassword","type","password","pInputText",""],["formControlName","confirmPassword","type","password","pInputText",""],["class","field col-12",4,"ngIf"],[1,"col-12"],["type","submit",1,"btn","btn--primary"],[1,"pi","pi-save"],["type","button",1,"btn","btn--light"],[1,"pi","pi-refresh"],[1,"p-error"],[1,"field","col-12"]],template:function(t,i){1&t&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(1,"div",1)(2,"label",2),e._uU(3,"Old Password"),e.qZA(),e.TgZ(4,"span",3),e._UZ(5,"i",4)(6,"input",5),e.qZA(),e.YNc(7,R,2,0,"small",6),e.qZA(),e.TgZ(8,"div",1)(9,"label",2),e._uU(10,"New Password"),e.qZA(),e.TgZ(11,"span",3),e._UZ(12,"i",4)(13,"input",7),e.qZA(),e.YNc(14,z,2,0,"small",6),e.qZA(),e.TgZ(15,"div",1)(16,"label",2),e._uU(17,"Confirm New Password"),e.qZA(),e.TgZ(18,"span",3),e._UZ(19,"i",4)(20,"input",8),e.qZA(),e.YNc(21,O,2,0,"small",6),e.YNc(22,K,2,0,"small",6),e.qZA(),e.YNc(23,G,3,1,"div",9),e.TgZ(24,"div",10)(25,"button",11),e._UZ(26,"i",12),e._uU(27,"Save "),e.qZA(),e.TgZ(28,"button",13),e._UZ(29,"i",14),e._uU(30,"Discuss "),e.qZA()()()),2&t&&(e.Q6J("formGroup",i.form),e.xp6(7),e.Q6J("ngIf",i.form.controls.oldPassword.touched&&i.form.controls.oldPassword.hasError("required")),e.xp6(7),e.Q6J("ngIf",i.form.controls.newPassword.touched&&i.form.controls.newPassword.hasError("required")),e.xp6(7),e.Q6J("ngIf",i.form.controls.confirmPassword.touched&&i.form.controls.confirmPassword.hasError("required")),e.xp6(1),e.Q6J("ngIf",i.form.controls.confirmPassword.touched&&i.form.controls.newPassword.value!=i.form.controls.confirmPassword.value&&!i.form.controls.confirmPassword.hasError("required")),e.xp6(1),e.Q6J("ngIf",i.errorMessage))},dependencies:[h.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,m.o],encapsulation:2})}let $=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[h.ez]}),n})();var W=u(5047);const ee=[{path:"",component:f,children:[{path:"",redirectTo:"account-info",pathMatch:"full"},{path:"account-info",component:d},{path:"account-security",component:g}]}];class _{static#e=this.\u0275fac=function(t){return new(t||_)};static#t=this.\u0275mod=e.oAB({type:_});static#i=this.\u0275inj=e.cJS({providers:[w.ez],imports:[h.ez,p.Bz.forChild(ee),l.u5,l.UX,I.kW,$,W.L$,m.j,E,y.EV]})}}}]);